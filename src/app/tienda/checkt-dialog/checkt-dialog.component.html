<div class="d-flex bd-highlight">
  <div class="p-2 flex-grow-1 bd-highlight">
    <h2>üööüí® METODO {{ data.metoD }}</h2>
  </div>
  <div class="p-2 bd-highlight">
    <button mat-mini-fab color="warn" (click)="mostrarAlerta()">
      <mat-icon>close</mat-icon>
    </button>
  </div>
</div>

<mat-dialog-content class="mat-typography">
  <div class="form row" *ngIf="!data.id">
    <div class="col-12" style="padding: 0 !important;">
      <br>
      <mat-list>
        <div mat-subheader>
          <div class="d-flex justify-content-between" style="width: 100%;">
            <div>
              <h3> <strong> Lista de Selecci√≥n promoci√≥n </strong> </h3>
            </div>
            <div></div>
            <div>
              <button mat-mini-fab color="primary" (click)="handleCantidad( true )">
                <mat-icon>add_box</mat-icon>
              </button>
            </div>

          </div>
        </div>
        <mat-list-item *ngFor="let item of listCantidad" style="height: auto; padding: 10px; background: #e5e5e5; border-radius: 15px;"> 
          <div class="row mat-elevation-z4" style="width: 110%;">
            <!--<div class="form-group col-6 " *ngIf="item.foto" style="text-align: center;">
              <img style="    width: 75px; border-radius: 40px;" [src]="item.foto" alt="">
            </div>-->
            <!-- Color -->
            <div class="form-group col-6 " *ngIf="datas.listColor.length === 0">
              <mat-form-field appearance="outline" class="example-full-width">
                <mat-label>Color</mat-label>
                <mat-icon matPrefix>palette</mat-icon>

                <input matInput type="text" [(ngModel)]="item.color" name="item.color" placeholder="Color del Producto" required>
              </mat-form-field>
            </div>

            <div class="form-group col-6 " *ngIf="datas.listColor.length">
              <mat-form-field appearance="outline" class="example-full-width">
                <mat-label>Color</mat-label>
                <mat-icon matPrefix>straighten</mat-icon>
                <mat-select [(ngModel)]="item.color" name="item.color" placeholder="Color del Producto" required (selectionChange)="handlePhoto( item );">
                  <mat-option *ngFor="let keyOf of item.listColor" [value]="keyOf.talla">
                    {{ keyOf.talla }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>

            <!-- Talla -->
            <div class="form-group col-6 " *ngIf="data.talla !== 'Unica' && item.ListTalla.length === 0">
              <mat-form-field appearance="outline" class="example-full-width">
                <mat-label>Talla</mat-label>
                <mat-icon matPrefix>straighten</mat-icon>
                <input matInput type="text" [(ngModel)]="item.talla" name="item.talla" placeholder="Talla del Producto" required >
              </mat-form-field>
            </div>

            <div class="form-group col-6 " *ngIf="data.talla !== 'Unica' && item.ListTalla.length">
              <mat-form-field appearance="outline" class="example-full-width">
                <mat-label>Talla</mat-label>
                <mat-icon matPrefix>straighten</mat-icon>
                <mat-select [(ngModel)]="item.talla" name="item.talla" placeholder="Talla del Producto" required>
                  <mat-option *ngFor="let keyOf of item.ListTalla" [value]="keyOf.tal_descripcion">
                    {{ keyOf.tal_descripcion }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
          <br><br>
        </mat-list-item>
       </mat-list>
    </div>
    <div>
      <br>
      <h2 style="text-align: center; color: black;">Datos de Envio</h2>
      <p style="text-align: center; color: red;">
        TU COMPRA ES UN COMPROMISO
        Por favor, si no est√°s seguro de comprar o recibir el producto, evita hacer el pedido. No aceptarlo generar√° un costo por devoluci√≥n.
      </p>
      <br>
    </div>
    <form #dataForm="ngForm" novalidate>
      <div class="form row" *ngIf="!data.id">

        <!-- Nombre y Apellido -->
        <div class="form-group col-12 col-sm-4" [ngClass]="{'has-error': isInvalid(dataForm, 'nombre')}">
          <mat-form-field appearance="outline" class="example-full-width">
            <mat-label>Nombre y Apellido</mat-label>
            <mat-icon matPrefix>account_circle</mat-icon>
            <input matInput type="text" [(ngModel)]="data.nombre" name="nombre" placeholder="Nombre y Apellido" required #nombre="ngModel" (change)="validadorInput()">
            <mat-error *ngIf="nombre.invalid && nombre.touched">Este campo es obligatorio.</mat-error>
          </mat-form-field>
        </div>

        <!-- N√∫mero de Tel√©fono -->
        <div class="form-group col-12 col-sm-4" [ngClass]="{'has-error': isInvalid(dataForm, 'telefono')}">
          <mat-form-field appearance="outline" class="example-full-width">
            <mat-label>N√∫mero de Tel√©fono</mat-label>
            <mat-icon matPrefix>phone</mat-icon>
            <input matInput type="number" [(ngModel)]="data.telefono" name="telefono" placeholder="N√∫mero de Tel√©fono" required #telefono="ngModel" (change)="validadorInput()">
            <mat-error *ngIf="telefono.invalid && telefono.touched">Este campo es obligatorio.</mat-error>
          </mat-form-field>
        </div>

        <!-- Direcci√≥n de Entrega -->
        <div class="form-group col-12 col-sm-4" [ngClass]="{'has-error': isInvalid(dataForm, 'direccion')}">
          <mat-form-field appearance="outline" class="example-full-width">
            <mat-label>Direcci√≥n de Entrega</mat-label>
            <mat-icon matPrefix>home</mat-icon>
            <input matInput type="text" [(ngModel)]="data.direccion" name="direccion" placeholder="Direcci√≥n de Entrega" required #direccion="ngModel" (change)="validadorInput()">
            <mat-error *ngIf="direccion.invalid && direccion.touched">Este campo es obligatorio.</mat-error>
          </mat-form-field>
        </div>

        <!-- Ciudad o Municipio -->
        <div class="form-group col-12 col-sm-4" [ngClass]="{'has-error': isInvalid(dataForm, 'ciudad')}">
          <mat-form-field appearance="outline" class="example-full-width">
            <mat-label>Ciudad o Municipio</mat-label>
            <mat-icon matPrefix>location_city</mat-icon>
            <input matInput type="text" [(ngModel)]="data.ciudad" name="ciudad" placeholder="Ciudad o Municipio" required #ciudad="ngModel" (change)="validadorInput()">
            <mat-error *ngIf="ciudad.invalid && ciudad.touched">Este campo es obligatorio.</mat-error>
          </mat-form-field>
        </div>
        
        <div class="form-group col-12 col-sm-4" [ngClass]="{'has-error': isInvalid(dataForm, 'barrio')}">
          <mat-form-field appearance="outline" class="example-full-width">
            <mat-label>Barrio o Localidad</mat-label>
            <mat-icon matPrefix>map</mat-icon>
            <input matInput type="text" [(ngModel)]="data.barrio" name="barrio" placeholder="Barrio o Localidad" required #barrio="ngModel" (change)="validadorInput()">
            <mat-error *ngIf="barrio.invalid && barrio.touched">Este campo es obligatorio.</mat-error>
          </mat-form-field>
        </div>

        <div class="form-group col-12 col-sm-4" [ngClass]="{'has-error': isInvalid(dataForm, 'pedidoCheck')}">
          <mat-label>Mis datos son correctos para el env√≠o</mat-label>
          <mat-checkbox class="example-margin" [(ngModel)]="data.pedidoCheck" name="pedidoCheck" required #pedidoCheck="ngModel">Si, acepto recibir el pedido.</mat-checkbox>
          <mat-checkbox class="example-margin" [(ngModel)]="data.terminoCheck" name="terminoCheck" required #terminoCheck="ngModel">Acepte nuestros t√©rminos y condiciones.</mat-checkbox>
        </div>
        
      </div>
    </form>

    <div class="col-12">
      <div class="tyslo-group">
        <div class="total-container">
          <div class="p-1">
            <div class="row-section">
              <div class="label-title">Subtotal</div>
              <div class="label-value">{{ _tools.monedaChange2(3, 2, this.data.costo1 || 0) }}</div>
            </div>
    
            <div class="row-section total-row">
              <div>Cantidad</div>
              <div class="total-value">{{ data.cantidadAd1 || 1 }}</div>
            </div>
    
            <!-- Descuento -->
            <div *ngIf="data.descuento" class="row-section total-row">
              <div>Descuentos</div>
              <div class="total-value">{{ _tools.monedaChange2(3, 2, (this.data.descuento) || 0) }}</div>
            </div>
    
            <!-- Servicio de pago anticipado -->
            <div *ngIf="data.metoD !== 'casa'" class="row-section total-row">
              <div>Servicio pago anticipado</div>
              <div class="total-value">-{{ _tools.monedaChange2(3, 2, ( datas.pro_uni_compra || 20000 ) || 0) }}</div>
            </div>
    
            <!-- Env√≠o -->
            <div class="row-section total-row">
              <div>Env√≠o</div>
              <div class="total-value">
                <span *ngIf="!data.pro_vendedor">
                  <mat-radio-group [(ngModel)]="data.envioT" (change)="suma()">
                    <mat-radio-button class="radio-btn" value="gratis">
                      <span>Gratis</span>
                    </mat-radio-button>
                    <mat-radio-button class="radio-btn" value="priorida">
                      <span>$5.000 Env√≠o Prioritario</span>
                    </mat-radio-button>
                  </mat-radio-group>
                </span>
                <span *ngIf="data.pro_vendedor">
                  {{ _formato.monedaChange(3, 2, data.pro_vendedor || 0) }}
                </span>
              </div>
            </div>
    
            <!-- Total -->
            <div class="row-section total-row total">
              <div>Total</div>
              <div class="total-value">
                {{ _tools.monedaChange2(3,2,(this.data.costo + data.pro_vendedor) || 0) }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
  </div>
  <div class="form row" *ngIf="data.id">
      <div class="col-12">
          <div class="d-flex justify-content-center">
              <div>
                  <h3>Chatear con un asesor sobre la venta realizada</h3>
                  <img src="./assets/icons/whatsapp.png" style="width: 80%;" alt="" (click)="mensajeWhat()">
              </div>
          </div>
      </div>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button cdkFocusInitial mat-raised-button color="primary" (click)="finalizando()" *ngIf="!data.id" [disabled]="disabled" style=" background: #28a745 !important;">
      <span>Confirmar Compra</span>
  </button>
</mat-dialog-actions>
